# Server Configuration
PORT=5003
NODE_ENV=production

# Database — on Railway, add a PostgreSQL plugin and copy the DATABASE_URL it generates.
# Example: postgresql://postgres:<password>@<host>.railway.internal:5432/railway
DATABASE_URL=postgresql://postgres:password@localhost:5432/tec_db

# JWT Secret — must match the secret used in auth-service
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=
JWT_EXPIRES_IN=1h
# Clock tolerance applied to JWT expiry checks (seconds, default 30)
JWT_CLOCK_TOLERANCE=30

# Pi Network (required for Pi payment integration)
# Obtain from https://developers.minepi.com
PI_API_KEY=
PI_APP_ID=

# Pi Network environment: 'true' for Testnet/Sandbox, 'false' for Mainnet/Production
PI_SANDBOX=true

# CORS — set to your gateway or frontend URL, or * to allow all origins
ALLOWED_ORIGINS=https://tec-core-backend-pi.up.railway.app
CORS_ORIGIN=https://tec-core-backend-pi.up.railway.app

# Redis — optional. When set, rate limiting and idempotency use Redis instead of in-memory store.
# Example: redis://default:<password>@<host>.railway.internal:6379
# REDIS_URL=

# Idempotency key TTL in milliseconds (default: 600000 = 10 minutes)
IDEMPOTENCY_TTL_MS=600000

# Rate limiting — requests per window per user/IP (window default: 60 seconds)
RATE_LIMIT_WINDOW=60000
RATE_LIMIT_INITIATE=5
RATE_LIMIT_CONFIRM=5
RATE_LIMIT_CANCEL=3
RATE_LIMIT_STATUS=30
# Global IP-based pre-auth rate limit (applied to all routes before JWT check)
RATE_LIMIT_GLOBAL_MAX=200
RATE_LIMIT_GLOBAL_WINDOW_MS=60000

# Maximum allowed payment amount (default: 1000000)
# MAX_AMOUNT_LIMIT is used by the Phase 3.1 controller; PAYMENT_MAX_LIMIT is the PR#13 alias.
MAX_AMOUNT_LIMIT=1000000
PAYMENT_MAX_LIMIT=1000000

# Logging (error, warn, info, debug)
LOG_LEVEL=info

# Service version (optional, shown in /health response)
SERVICE_VERSION=1.0.0

# Pi API request timeouts in milliseconds (default: 30000ms = 30 seconds)
# PI_API_APPROVE_TIMEOUT=30000
# PI_API_COMPLETE_TIMEOUT=30000
