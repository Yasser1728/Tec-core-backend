# ─── Server ───────────────────────────────────────────────────────────────────
PORT=5003
NODE_ENV=production
SERVICE_VERSION=1.0.0

# ─── Database ─────────────────────────────────────────────────────────────────
# On Railway, add a PostgreSQL plugin and copy the DATABASE_URL it generates.
# Example: postgresql://postgres:<password>@<host>.railway.internal:5432/railway
DATABASE_URL=postgresql://postgres:password@localhost:5432/tec_payment_db

# ─── JWT ──────────────────────────────────────────────────────────────────────
# Must match the secret used in auth-service.
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=
# Clock tolerance applied to JWT expiry checks (seconds, default 30)
JWT_CLOCK_TOLERANCE=30

# ─── CORS ─────────────────────────────────────────────────────────────────────
# Comma-separated list of allowed origins.  ALLOWED_ORIGINS is preferred;
# CORS_ORIGIN is kept for backwards compatibility.
ALLOWED_ORIGINS=https://tec-core-backend-pi.up.railway.app
# CORS_ORIGIN=https://tec-core-backend-pi.up.railway.app

# ─── Rate limiting ────────────────────────────────────────────────────────────
# Global IP-based pre-auth rate limit (applied to all routes before JWT check).
RATE_LIMIT_GLOBAL_MAX=200
RATE_LIMIT_GLOBAL_WINDOW_MS=60000
# Per-route request limits (max requests / window duration in ms).
RATE_LIMIT_INITIATE_MAX=5
RATE_LIMIT_INITIATE_WINDOW_MS=60000
RATE_LIMIT_CONFIRM_MAX=5
RATE_LIMIT_CONFIRM_WINDOW_MS=60000
RATE_LIMIT_CANCEL_MAX=3
RATE_LIMIT_CANCEL_WINDOW_MS=60000
RATE_LIMIT_STATUS_MAX=30
RATE_LIMIT_STATUS_WINDOW_MS=60000

# ─── Idempotency ──────────────────────────────────────────────────────────────
# How long (ms) a cached idempotency response is retained (default 10 minutes).
IDEMPOTENCY_TTL_MS=600000

# ─── Payment limits ───────────────────────────────────────────────────────────
# Maximum single-payment amount (Decimal string, default 1 000 000).
PAYMENT_MAX_LIMIT=1000000

# ─── Logging ──────────────────────────────────────────────────────────────────
# One of: error | warn | info | debug
LOG_LEVEL=info
